pico-8 cartridge // http://www.pico-8.com
version 32
__lua__
-- deep asleep
-- by sestrenexsis
--  & equalenergy
-- https://github.com/sestrenexsis/ld48_deeper_and_deeper

--[[
 you are a powerful warrior that
 has been put to sleep by a
 wizard. you must wake yourself
 up by finding and defeating
 your subconscious.
--]]

--[[
game states
 t: title screen
 a: adventure
 
 t <-> a

adventure states
 o: overworld
 h: house
 c: combat
--]]
-- change keypress delays
poke(0x5f5c,6)
poke(0x5f5d,6)

--globals
_me="sestrenexsis"
_cart="ldjam48"
--cartdata(_me.."_".._cart.."_1")
--_version=1
_herox=0  -- hero tile x
_heroy=0  -- hero tile y
_herof="" -- hero facing dir
_camx=0 -- camera target x
_camy=0 -- camera target y
_loc={
	start={x=9,y=15}
}

function _init()
	_herox=_loc.start.x
	_heroy=_loc.start.y
	_herof="dn"
end

function _update60()
	local s=0
	if btnp(⬅️) then
		s=mget(_herox-1,_heroy)
		if fget(s,0) then
			_herox-=1
		end
		_herof="lf"
	elseif btnp(➡️) then
		s=mget(_herox+1,_heroy)
		if fget(s,0) then
			_herox+=1
		end
		_herof="rt"
	end
	if btnp(⬆️) then
		s=mget(_herox,_heroy-1)
		if fget(s,0) then
			_heroy-=1
		end
		_herof="up"
	elseif btnp(⬇️) then
		s=mget(_herox,_heroy+1)
		if fget(s,0) then
			_heroy+=1
		end
		_herof="dn"
	end
	_camx=8*_herox-64
	_camy=8*_heroy-64
	if _camx<0 then
		_camx=0
	end
	if _camy<0 then
		_camy=0
	end
end

function _draw()
	cls()
	camera(_camx,_camy)
	map(0,0,0,0,128,128)
	local frm=2
	local flp=false
	if _herof=="dn" then
		frm=1
	elseif _herof=="lf" then
		frm=3
		flp=true
	elseif _herof=="rt" then
		frm=3
	end
	local x=8*_herox
	local y=8*(_heroy-1)
	spr(frm,x,y,1,2,flp)
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070009900a0000000000099900a0004444440000000000000000000000000000000002440442000000000000000000000000000000000000000000000000
00077000009999a009990aa000999900044444440000000000000000000000000000000004440424000000000000000000000000000000000000000000000000
0007700000999a0000999a0000999aa0099404700000000000000000000000000000000024222444000000000000000000000000000000000000000000000000
007007000091d1a000999900009dd1a0094404600000000000000000000000000000000044444424000000000000000000000000000000000000000000000000
000000000001f100000999a0000ff100094404400000000000000000000000000000000002440422000000000000000000000000000000000000000000000000
00000000000fff2000099990000fff2004440440000000000000000000000000000000000f990f9f000000000000000000000000000000000000000000000000
10000000000752800008880000885700099400000000000004470000166161660000000000000000cccc7c7c0000000000000000000000000000000000000000
12000000000618800008282008821600094449000044490004460000161166160000000000000000ccc7cc7c0000000000000000000000000000000000000000
41100000000d11800008828008881d00094444444444444409940000616616610000000000000000cccccccc0000000000000000000000000000000000000000
44220000000115800002888008281500004444444444444409440000161661160000000000000000c77cc7cc0000000000000000000000000000000000000000
55411000000155000008282008285500004704700470047009440000616111610000000000000000cc7cc7cc0000000000000000000000000000000000000000
44542200000ddd00000dd820088ddd00004604600460046004440000616161660000000000000000ccccc7c70000000000000000000000000000000000000000
54541120000d0d00000d0d80080d0d00004404400440044004440000161616160000000000000000ccccccc70000000000000000000000000000000000000000
54455411000404000004040000040400004404400440044004440000666161610000000000000000cc77cccc0000000000000000000000000000000000000000
515515550000000044445444000000000000000000000000000222000000000000000776000000006ccccccc0000000000000000000000000000000000000000
51551555022000004544544400000000001115d000000000002ccc20000000000000076600000000cc7cc7cc0000000000000000000000000000000000000000
111111110dd0d2004545445500000000011bb7dd0000000002ccc772000000000000076600000000cc6cc7cc0000000000000000000000000000000000000000
1555515500000000445444540000000001bbb67d0000000002cc7762000000000000066600000000c77cc6cc0000000000000000000000000000000000000000
1555515502d020225444444400011000013bbbb50000000002c776c2000000000000066600000000c76cccc70000000000000000000000000000000000000000
11111111022020d244445544002552000133bbb10000000002776cc2166667770000066600000000c6ccc7c70000000000000000000000000000000000000000
555551550099a9004454444401444410013333b10099a9000266ccc2166666670000066600000000cccc77c60000000000000000000000000000000000000000
11111111099aa9a0445455442454554101111111099aa9a0022222221666666600000111000000007ccc66cc0000000000000000000000000000000000000000
00000001099aa9a03bbbbbbb3444444b49444444bbb3bbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000021099aa9a0bbb3bbbbb444994b94449944b3bbbb3300000000000000000000000000000000000000000000000000000000000000000000000000000000
0000011409aa99a0b3bb3bb334944443449444443bb3bbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000
00002245099aa1a0bbbbbb3b3444494344444944bbbb3bb400000000000000000000000000000000000000000000000000000000000000000000000000000000
00011445099aa1a03bb33bbb3444494b44444949bbbbbb4900000000000000000000000000000000000000000000000000000000000000000000000000000000
002255440a9aa9a0b3bb3bbbb949444b494944493bbbb44900000000000000000000000000000000000000000000000000000000000000000000000000000000
011444550a99aaa0bbbbbbbb3949444349494444bbb9444400000000000000000000000000000000000000000000000000000000000000000000000000000000
124455440aaaa9a0bbbb33b33944499b49444994bb44499400000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
3227272727272727272727272727272700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820203232323232323232323232323200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820203232323232323232323232323200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820203224323232323232323232323200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820203232323232323232323232323200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820203232323232322432323232323200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820203232323232323232323232323232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820203232323232322332323232323232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820203232323232302210323232323232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820200415151530222222101a1a323232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820201632323220202020201a1a1a3232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820201632323220202120201a1a1a1a32000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820201415151520203120201a1a1a1a32000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
28202032323232323232321a1a1a1a3232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820203232323232323232090909323232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820202a2a2a322a2a32322a2a2a323232000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820202a2a2a2a2a2a2a2a2a2a2a2a2a2a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820202a2a2a2a2a2a2a2a2a2a2a2a2a2a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2820202a2a2a2a2a2a2a2a2a2a2a2a2a2a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000002020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000020171717171717171717171717200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000020171717171717171717171717200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000020171717171717171717171717200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000020171717171717171717171717200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000020171717171717171717171717200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000020262626262626252626262626200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000020202020202020312020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000200002c0512b054280552705524051210521f05300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
271200200e07510064100310e07710022100520f0430f0360f0640f0470f0310c0520d02516073160441705217023160750e04614057130270f037120710f044140510f0620f027170350f0510e047150220e053
6f100020130211302113021130210f0210f0210f0210f0210f02118021180211802118021180211202112021120211202114021140211402114021140211402118021180210f0210f0210f021120211202112021
__music__
03 02020202

